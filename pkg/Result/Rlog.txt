> system.time(mlebobyqa <- MLE_sw(c(0.02,0.01,0.003),rep(0,3),rep(1,3),trees[[1]],sim[1:4,],m=20,al,mumat,protein_op=rep(1,100),root=start_seq,trace=1))
fn is  negloglike 
Function has  3  arguments
par[ 1 ]:  0   <? 0.02   <? 1     In Bounds    
par[ 2 ]:  0   <? 0.01   <? 1     In Bounds   In Bounds   
par[ 3 ]:  0   <? 0.003   <? 1     In Bounds   In Bounds   In Bounds  
Analytic gradient not made available.
Analytic Hessian not made available.
all.methods is TRUE -- Using all available methods
[1] "L-BFGS-B" "nlminb"   "spg"      "Rcgmin"   "Rvmmin"   "bobyqa"  
Looking for method =  L-BFGS-B 
Looking for method =  nlminb 
Looking for method =  spg 
Looking for method =  Rcgmin 
Looking for method =  Rvmmin 
Looking for method =  bobyqa 
Scale check -- log parameter ratio= 0.8239087   log bounds ratio= 0 
Method:  L-BFGS-B 
iter    0 value 848.948935
iter   10 value 848.400848
final  value 848.400792 
converged
Post processing for method  L-BFGS-B 
Successful convergence! 
Compute Hessian approximation at finish of  L-BFGS-B 
Compute gradient approximation at finish of  L-BFGS-B 
Gradient computation failure!
Gradient not computable after method L-BFGS-B 
Save results from method  L-BFGS-B 
Assemble the answers
Method:  nlminb 
  0:     850.74922: 0.0200000 0.0100000 0.00300000
  1:     848.94894:  0.00000 0.989976  0.00000
  2:     848.90027: 0.00405645  1.00000  0.00000
  3:     848.89132: 0.00615657 0.900022  0.00000
  4:     848.88913: 0.00431406 0.899968  0.00000
  5:     848.88777: 0.00500706 0.898260  0.00000
  6:     848.75460: 0.00771037 0.426382  0.00000
  7:     848.64285: 0.00967182 0.274616  0.00000
  8:     848.59043: 0.0104010 0.223206  0.00000
  9:     848.46949: 0.0118466 0.120387  0.00000
 10:     848.45692: 0.0120149 0.108349  0.00000
 11:     848.39293: 0.0102177 0.0120460 1.81836e-05
 12:     848.34704: 0.00920506 0.0154614 0.000104919
 13:     848.26846: 0.0132555 0.00179560 0.000168146
 14:     848.26640: 0.0132556 0.00179536 0.000151123
 15:     848.26635: 0.0132578 0.00177855 0.000149585
 16:     848.26367: 0.0134081 0.000699403 0.000153291
 17:     848.26154: 0.0130793  0.00000 0.000156204
 18:     848.26144: 0.0129355  0.00000 0.000143951
 19:     848.26128: 0.0130230  0.00000 0.000149558
 20:     848.26128: 0.0130230  0.00000 0.000149558
Post processing for method  nlminb 
Successful convergence! 
Compute Hessian approximation at finish of  nlminb 
Compute gradient approximation at finish of  nlminb 
Gradient computation failure!
Gradient not computable after method nlminb 
Save results from method  nlminb 
Assemble the answers
Method:  spg 
iter:  0  f-value:  850.7492  pgrad:  0.99 
iter:  10  f-value:  848.9  pgrad:  0.07398171 
iter:  20  f-value:  848.8998  pgrad:  0.1302863 
iter:  30  f-value:  848.8998  pgrad:  0.08882807 
iter:  40  f-value:  848.8998  pgrad:  0.1125295 
iter:  50  f-value:  848.8998  pgrad:  0.04719823 
iter:  60  f-value:  848.8998  pgrad:  0.09401901 
Post processing for method  spg 
Successful convergence! 
Compute Hessian approximation at finish of  spg 
Compute gradient approximation at finish of  spg 
Gradient computation failure!
Gradient not computable after method spg 
Save results from method  spg 
Assemble the answers
Method:  Rcgmin 
Rcgmin -- J C Nash 2009 - bounds constraint version of new CG
an R implementation of Alg 22 with Yuan/Dai modification
Initial function value= 850.7492 
Initial fn= 850.7492 
1   0   1   850.7492   last decrease= NA 
3   1   2   849.5161   last decrease= 1.233135 
5   2   3   848.4248   last decrease= 1.091259 
*8   3   4   848.3986   last decrease= 0.02621054 
*11   4   5   848.3771   last decrease= 0.02154323 
Yuan/Dai cycle reset
11   5   1   848.3771   last decrease= NA 
******************
  Converged -- no progress on new CG cycle 
Rcgmin seems to have converged 
Post processing for method  Rcgmin 
Successful convergence! 
Compute Hessian approximation at finish of  Rcgmin 
Compute gradient approximation at finish of  Rcgmin 
Save results from method  Rcgmin 
Assemble the answers
Method:  Rvmmin 
Rvmmin -- J C Nash 2009 - an R implementation of Alg 21
Problem of size n= 3   Extra arguments:
list()
Initial fn= 850.7492 
  1   1   850.7492 
  2   2   849.5374 
  3   3   848.9489 
No acceptable point
Reset to gradient search
  3   3   848.9489 
No acceptable point
Converged 
Seem to be done VM
Post processing for method  Rvmmin 
Successful convergence! 
Compute Hessian approximation at finish of  Rvmmin 
Compute gradient approximation at finish of  Rvmmin 
Hessian not computable after method Rvmmin 
Save results from method  Rvmmin 
Assemble the answers
Method:  bobyqa 
At return
2304:     848.26128: 0.0130133  0.00000 0.000149282
Post processing for method  bobyqa 
Successful convergence! 
Compute Hessian approximation at finish of  bobyqa 
Compute gradient approximation at finish of  bobyqa 
Gradient computation failure!
Gradient not computable after method bobyqa 
Save results from method  bobyqa 
Assemble the answers
Sort results
     user    system   elapsed 
16873.486    32.658 17123.165 
Warning messages:
1: In optimx(start_pt, negloglike, lower = lowerb, upper = upperb,  :
  Gradient not computable after method L-BFGS-B
2: In optimx(start_pt, negloglike, lower = lowerb, upper = upperb,  :
  Gradient not computable after method nlminb
3: In optimx(start_pt, negloglike, lower = lowerb, upper = upperb,  :
  Gradient not computable after method spg
4: In Rcgminb(par, fn, gr, lower = lower, upper = upper, bdmsk = bdmsk,  :
  A NULL gradient function is being replaced with fwd diff for Rcgmin
5: In Rvmmin(par = par, fn = ufn, gr = ugr, lower = lower, upper = upper,  :
  Numerical gradients may be inappropriate for Rvmmin
6: In optimx(start_pt, negloglike, lower = lowerb, upper = upperb,  :
  Hessian not computable after method Rvmmin
7: In optimx(start_pt, negloglike, lower = lowerb, upper = upperb,  :
  Gradient not computable after method bobyqa
> mlebobyqa
                                       par  fvalues   method  fns grs itns conv  KKT1  KKT2  xtimes
5 0.000000e+00, 1.034424e-02, 2.256296e-07 848.9489   Rvmmin    3   3 NULL    0 FALSE    NA  79.421
3       0.00447972, 0.99977144, 0.00000000 848.8998      spg   72  NA   64    0    NA    NA 1438.45
1       0.00952190, 0.04085615, 0.00000000 848.4008 L-BFGS-B   26  26 NULL    0    NA    NA 985.962
4 0.0091489976, 0.0101906008, 0.0001940083 848.3771   Rcgmin   29   6 NULL    0 FALSE FALSE 252.424
2 0.0130229957, 0.0000000000, 0.0001495579 848.2613   nlminb   44  69   20    0    NA    NA 645.068
6 0.0130133390, 0.0000000000, 0.0001492817 848.2613   bobyqa 2304  NA NULL    0    NA    NA 12369.3
