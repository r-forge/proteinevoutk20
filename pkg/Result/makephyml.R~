methods = c("LG","WAG", "JTT","MtREV", "Dayhoff", "DCMut", "RtREV", "CpREV", "VT", "Blosum62", "MtMam", "MtArt", "HIVw", "HIVb")
freq=c("e","m")

for(mtd in methods){
  for(fq in freq){
    run.id = paste(mtd,"+",fq,sep="")
    ## M - (freq = model estimated) and M + F - (freq=empirical)
    line1 = paste("phyml -i rokasAA -d aa -q -m ", mtd, " -f ",fq," -v 0 -c 1 -u gtr_newick -o r --run_id ",run.id," > /dev/null &",sep="")
    ## M + I and M + I + F
    line2 = paste("phyml -i rokasAA -d aa -q -m ", mtd, " -f ",fq," -v e -c 1 -u gtr_newick -o r --run_id ",run.id,"+I"," > /dev/null &",sep="")
    ## M + G and M + G + F
    line3 = paste("phyml -i rokasAA -d aa -q -m ", mtd, " -f ",fq," -v 0 -c 4 -a e -u gtr_newick -o r --run_id ",run.id,"+G"," > /dev/null &",sep="")
    ## M + I + G  and M + I + G + F
    line4 = paste("phyml -i rokasAA -d aa -q -m ", mtd, " -f ",fq," -v e -c 4 -a e -u gtr_newick -o r --run_id ",run.id,"+I+G"," > /dev/null &",sep="")
    cat(line1,"\n",line2,"\n",line3,"\n",line4,"\n",file=paste("phyml_",mtd,"_",fq,".sh",sep=""))
    system(paste('chmod u+x phyml_',mtd,'_',fq,'.sh',sep=""))
  }
}
